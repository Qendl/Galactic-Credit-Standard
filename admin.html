<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CEO Panel</title>
    
    <style>
        /* === 1. ADMIN STYLES (DARK RED ACCENT) === */
        body { 
            background-color: #050505; 
            color: #ffffff; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0; padding: 20px; 
            text-align: center;
            -webkit-tap-highlight-color: transparent;
            /* –ú–æ–¥–∞–ª–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ —Å–≤–µ—Ä—Ö—É */
            --w3m-z-index: 100000 !important;
        }

        .header { margin-bottom: 30px; border-bottom: 1px solid #333; padding-bottom: 20px; }
        
        h2 { font-weight: 800; color: #ff3b30; margin: 0; letter-spacing: 1px; }
        p.subtitle { color: #666; font-size: 12px; margin-top: 5px; }

        /* –ö–ê–†–¢–û–ß–ö–ò –§–£–ù–ö–¶–ò–ô */
        .admin-card {
            background: #111; 
            border: 1px solid #333; 
            border-radius: 16px; 
            padding: 20px; 
            margin-bottom: 20px; 
            text-align: left;
        }
        
        .card-title { 
            color: #888; font-size: 11px; font-weight: 700; text-transform: uppercase; 
            margin-bottom: 15px; display: block; letter-spacing: 0.5px;
        }

        /* –ü–û–õ–Ø –í–í–û–î–ê */
        .input-field {
            width: 100%; 
            padding: 14px; 
            margin-bottom: 10px;
            background: #000; 
            border: 1px solid #444; 
            color: white; 
            border-radius: 10px;
            box-sizing: border-box; 
            font-size: 16px;
            font-family: monospace;
        }
        .input-field:focus { border-color: #ff3b30; outline: none; }

        /* –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô */
        .btn {
            width: 100%; padding: 14px; border-radius: 12px; 
            font-weight: bold; cursor: pointer; font-size: 15px; 
            transition: 0.2s; border: none; margin-top: 5px;
        }
        
        .btn-connect {
            background: #fff; color: #000; margin-top: 15px; width: auto; padding: 10px 25px; border-radius: 30px;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ "–û–ø–∞—Å–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è" */
        .btn-red { 
            background: linear-gradient(135deg, #ff3b30, #ff0000); 
            color: white; 
            box-shadow: 0 4px 15px rgba(255, 59, 48, 0.3);
        }
        
        /* –ö–Ω–æ–ø–∫–∞ "–§–∏–Ω–∞–Ω—Å–æ–≤" */
        .btn-green { 
            background: linear-gradient(135deg, #34c759, #28a745); 
            color: white; 
            box-shadow: 0 4px 15px rgba(52, 199, 89, 0.3);
        }
        
        /* –ö–Ω–æ–ø–∫–∞ "Approve" */
        .btn-grey { background: #333; color: #fff; border: 1px solid #555; }

        .btn:active { transform: scale(0.97); opacity: 0.9; }

        /* –õ–û–ì–ò */
        .log-area { 
            font-family: monospace; font-size: 10px; color: #666; 
            margin-top: 30px; text-align: left; 
        }

    </style>

    <!-- AppKit & Ethers -->
    <script type="module">
        import { createWeb3Modal, defaultConfig } from 'https://esm.sh/@web3modal/ethers@5.0.0'
        import { BrowserProvider, Contract, parseUnits } from 'https://esm.sh/ethers@6.7.0'

        // 1. CONFIG
        const projectId = '7b83e930c9c584b3d751e271babdb18d' 

        const polygon = {
            chainId: 137, name: 'Polygon', currency: 'POL',
            explorerUrl: 'https://polygonscan.com', rpcUrl: 'https://polygon-rpc.com'
        }
        
        const metadata = { name: 'Galactic CEO', description: 'Admin Panel', url: 'https://qendl.github.io', icons: [] }
        
        // 2. INIT
        const modal = createWeb3Modal({
            ethersConfig: defaultConfig({ metadata }), chains: [polygon], projectId,
            enableAnalytics: false, enableEmail: false, allWallets: 'SHOW', themeMode: 'dark',
            themeVariables: { '--w3m-accent': '#ff3b30', '--w3m-z-index': '100000' }
        })

        // –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
        window.modal = modal;
        window.BrowserProvider = BrowserProvider;
        window.Contract = Contract;
        window.parseUnits = parseUnits;

        // –°–ª–µ–¥–∏–º –∑–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
        modal.subscribeProvider((state) => {
            const btn = document.getElementById('connectBtn');
            if (state.isConnected && state.address) {
                btn.innerText = "üîí Owner: " + state.address.substring(0,6) + "...";
                btn.style.border = "1px solid #ff3b30";
                btn.style.color = "#ff3b30";
                btn.style.background = "#1a1a1a";
            } else {
                btn.innerText = "Connect Admin Key";
            }
        })
    </script>
</head>
<body>

    <div class="header">
        <h2>CEO CONTROL</h2>
        <p class="subtitle">Restricted to Contract Owner Only</p>
        <button id="connectBtn" class="btn btn-connect" onclick="window.modal.open()">Connect Admin Key</button>
    </div>

    <!-- 1. –ó–ê–†–ü–õ–ê–¢–ê -->
    <div class="admin-card">
        <span class="card-title">üí∏ PAYROLL SYSTEM (BATCH)</span>
        
        <input type="text" id="payAddress" class="input-field" placeholder="Wallet Address (0x...)">
        <input type="number" id="payAmount" class="input-field" placeholder="Amount (CRED)">
        
        <!-- –°–Ω–∞—á–∞–ª–∞ –∞–ø–ø—Ä—É–≤, –ø–æ—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–∫–∞ -->
        <button onclick="approveCred()" class="btn btn-grey">1. Approve Contract</button>
        <button onclick="sendSalary()" class="btn btn-red">2. Execute Payment</button>
    </div>

    <!-- 2. –°–ï–ô–§ / –í–ï–°–¢–ò–ù–ì -->
    <div class="admin-card">
        <span class="card-title">üè¶ VESTING SAFE RELEASE</span>
        <p style="font-size:13px; color:#aaa; margin-top:0;">Release unlocked team tokens to owner wallet.</p>
        <button onclick="releaseVesting()" class="btn btn-green">Claim Available Tokens</button>
    </div>

    <!-- 3. –ò–ù–§–õ–Ø–¶–ò–Ø -->
    <div class="admin-card">
        <span class="card-title">üñ® MINT INFLATION (YEARLY)</span>
        <p style="font-size:13px; color:#aaa;">Can only be called once a year.</p>
        <button onclick="mintInflation()" class="btn btn-grey">Mint 0.5%</button>
    </div>

    <div id="logs" class="log-area">Status: Ready.</div>

    <script>
        // ===============================================
        // ‚ö†Ô∏è –ó–ê–ü–û–õ–ù–ò–¢–ï –ê–î–†–ï–°–ê –í–ê–®–ò–• –ö–û–ù–¢–†–ê–ö–¢–û–í –ù–ò–ñ–ï ‚ö†Ô∏è
        // ===============================================
        
        const ADDR_TOKEN   = '0x5F9016b380782bd98D2C7893e5b2E39e95Dd1378'; // CRED Token
        const ADDR_BATCH   = '0xeedadF904bCc8820464f3d9c3454056569Ad2d08'; // –ù–∞–π–¥–∏—Ç–µ –∞–¥—Ä–µ—Å BatchTransfer
        const ADDR_VESTING = '0x452A5AbE5773Bd9f7268838b4e32560364020F9A'; // –ï—Å–ª–∏ —ç—Ç–æ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ Vesting? (–ü—Ä–æ–≤–µ—Ä—å—Ç–µ)

        // ABI (–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
        const ABI_ERC20 = [
            "function approve(address, uint256) external returns (bool)",
            "function mintAnnualInflation() external"
        ];
        const ABI_BATCH = [
            "function multisend(address token, address[] recipients, uint256[] amounts) external"
        ];
        const ABI_VESTING = [
            "function release(address token) external"
        ];

        // --- –õ–û–ì–ò–ö–ê ---

        async function getSigner() {
            if (!window.ethereum) { alert("No wallet found"); return null; }
            if (!window.modal.getIsConnected()) { window.modal.open(); return null; }
            
            const provider = new window.BrowserProvider(window.ethereum);
            return await provider.getSigner();
        }

        function log(msg) {
            document.getElementById('logs').innerText = "> " + msg;
            console.log(msg);
        }

        // 1. –ó–ê–†–ü–õ–ê–¢–ê
        async function approveCred() {
            const signer = await getSigner(); if(!signer) return;
            try {
                const token = new window.Contract(ADDR_TOKEN, ABI_ERC20, signer);
                log("Approving...");
                // –î–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ 1 –º–ª–Ω —Ç–æ–∫–µ–Ω–æ–≤ (—á—Ç–æ–±—ã –Ω–µ –∂–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑)
                const tx = await token.approve(ADDR_BATCH, window.parseUnits("1000000", 18));
                await tx.wait();
                log("Approved! Ready to send.");
                alert("‚úÖ Contract Approved");
            } catch(e) { log(e.code || e.message); }
        }

        async function sendSalary() {
            const signer = await getSigner(); if(!signer) return;
            const to = document.getElementById('payAddress').value;
            const amt = document.getElementById('payAmount').value;
            
            if(!to || !amt) return alert("Fill data!");

            try {
                const batch = new window.Contract(ADDR_BATCH, ABI_BATCH, signer);
                log("Sending salary...");
                
                // –ú—É–ª—å—Ç–∏—Å–µ–Ω–¥–µ—Ä —Ç—Ä–µ–±—É–µ—Ç –ú–∞—Å—Å–∏–≤—ã, –¥–∞–∂–µ –¥–ª—è 1 —á–µ–ª–æ–≤–µ–∫–∞
                const tx = await batch.multisend(
                    ADDR_TOKEN, 
                    [to], 
                    [window.parseUnits(amt, 18)]
                );
                
                log("Tx Sent... Waiting...");
                await tx.wait();
                log("Done!");
                alert("‚úÖ Salary Paid Successfully!");
                
            } catch(e) { log("Error: " + (e.reason || e.message)); }
        }

        // 2. –°–ï–ô–§
        async function releaseVesting() {
            const signer = await getSigner(); if(!signer) return;
            try {
                const vesting = new window.Contract(ADDR_VESTING, ABI_VESTING, signer);
                log("Releasing tokens...");
                const tx = await vesting.release(ADDR_TOKEN);
                await tx.wait();
                log("Tokens Released to your Wallet.");
                alert("üí∞ Tokens Claimed!");
            } catch(e) { 
                log("Error: " + e.message); 
                alert("Failed: Maybe no tokens to release yet?");
            }
        }

        // 3. –ò–ù–§–õ–Ø–¶–ò–Ø
        async function mintInflation() {
            const signer = await getSigner(); if(!signer) return;
            try {
                const token = new window.Contract(ADDR_TOKEN, ABI_ERC20, signer);
                log("Minting inflation...");
                const tx = await token.mintAnnualInflation();
                await tx.wait();
                alert("‚úÖ Minted 0.5% successfully!");
            } catch(e) { 
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
                if(e.message.includes("Too early")) alert("Too early! Inflation available once a year.");
                else log("Error: " + e.message);
            }
        }
    </script>
</body>
</html>
