<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Galactic Super App</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Ethers.js –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        /* –û–°–ù–û–í–ù–û–ô –°–¢–ò–õ–¨ */
        body { 
            background-color: #0b0b0f; 
            color: #fff; 
            font-family: 'Segoe UI', Helvetica, sans-serif; 
            text-align: center; 
            margin: 0; 
            padding-bottom: 90px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –Ω–∏–∂–Ω–µ–≥–æ –º–µ–Ω—é */
            -webkit-tap-highlight-color: transparent;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ */
        .tab-content { display: none; padding: 20px; animation: fadeIn 0.4s; }
        .tab-content.active { display: block; }

        /* –õ–æ–≥–æ—Ç–∏–ø */
        .logo { 
            width: 100px; 
            height: 100px; 
            margin: 20px auto 10px; 
            display: block; 
            border-radius: 50%; 
            box-shadow: 0 0 35px rgba(160, 100, 255, 0.4); 
        }
        
        h2 { font-weight: 400; letter-spacing: 1px; margin-bottom: 25px; color: #eee; }
        h4 { margin: 0 0 10px 0; color: #FFD700; font-size: 18px; }
        p { color: #aaa; font-size: 13px; line-height: 1.4; margin: 0 0 15px 0; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card { 
            background: #1c1c20; 
            border: 1px solid #333; 
            border-radius: 18px; 
            padding: 20px; 
            margin-bottom: 15px; 
            text-align: left; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn { 
            width: 100%; 
            padding: 14px; 
            border-radius: 12px; 
            font-weight: 700; 
            border: none; 
            cursor: pointer; 
            margin-top: 8px; 
            font-size: 15px;
            transition: 0.2s;
        }
        .btn-primary { 
            background: linear-gradient(135deg, #FFD700, #FDB931); 
            color: #000; 
            box-shadow: 0 4px 12px rgba(253, 185, 49, 0.3);
        }
        .btn-primary:active { transform: scale(0.98); opacity: 0.9; }
        
        .btn-outline { 
            background: transparent; 
            border: 1px solid #555; 
            color: #fff; 
        }
        .btn-outline:active { background: #222; }

        /* QR –∫–æ–¥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .qr-box {
            background: white;
            padding: 10px;
            border-radius: 12px;
            display: inline-block;
            margin-top: 20px;
        }

        /* –ù–ò–ñ–ù–ï–ï –ú–ï–ù–Æ –ù–ê–í–ò–ì–ê–¶–ò–ò */
        .bottom-nav { 
            position: fixed; 
            bottom: 0; 
            width: 100%; 
            background: rgba(21, 21, 24, 0.95); 
            backdrop-filter: blur(10px);
            border-top: 1px solid #333; 
            display: flex; 
            justify-content: space-around; 
            padding: 12px 0 25px 0; 
            z-index: 1000;
        }
        .nav-item { 
            color: #666; 
            font-size: 11px; 
            font-weight: 600; 
            cursor: pointer; 
            text-align: center;
            width: 33%;
            transition: 0.2s;
        }
        .nav-item.active { color: #FFD700; transform: scale(1.05); }
        .nav-icon { font-size: 22px; display: block; margin-bottom: 4px; }

        /* –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–æ–≤ –Ω–∞ —ç–∫—Ä–∞–Ω–µ */
        #console { 
            font-family: monospace; 
            font-size: 11px; 
            color: #0f0; 
            margin-top: 20px; 
            text-align: left; 
            padding: 10px;
            opacity: 0.8;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <!-- ================= –í–ö–õ–ê–î–ö–ê 1: –ö–û–®–ï–õ–ï–ö ================= -->
    <div id="wallet" class="tab-content active">
        <img src="https://raw.githubusercontent.com/Qendl/Galactic-Credit-Standard/main/logo.png" class="logo" alt="CRED">
        <h2>Galactic Wallet</h2>
        
        <!-- –ü–∞–Ω–µ–ª—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
        <button onclick="connectWallet()" class="btn btn-primary" id="connectBtn">
            ü¶ä Connect Wallet
        </button>
        <button onclick="addToken()" class="btn btn-outline">
            ‚ûï Add Icon to Wallet
        </button>

        <!-- QR –ö–æ–¥ -->
        <div class="qr-box">
            <img src="https://raw.githubusercontent.com/Qendl/Galactic-Credit-Standard/main/QR_Official.png" width="200" style="display:block">
        </div>
        <p style="margin-top:10px; color:#666">Scan to Pay (Polygon/ETH)</p>
    </div>


    <!-- ================= –í–ö–õ–ê–î–ö–ê 2: –°–ï–†–í–ò–°–´ ================= -->
    <div id="services" class="tab-content">
        <h2>DeFi Services</h2>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 1: –ü–æ–¥–ø–∏—Å–∫–∞ -->
        <div class="card">
            <h4>üíé VIP Club Membership</h4>
            <p>Get access to private investor chat and voting rights.</p>
            <p style="color: #fff;">Price: <strong>50 CRED / Month</strong></p>
            
            <div style="display: flex; gap: 10px;">
                <button onclick="approveCred()" class="btn btn-outline" style="font-size:13px">1. Approve</button>
                <button onclick="subscribe()" class="btn btn-primary" style="font-size:13px">2. Subscribe</button>
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 2: –ë–∏—Ä–∂–∞ -->
        <div class="card">
            <h4>ü¶Ñ Quick Buy</h4>
            <p>Purchase CRED instantly via Uniswap Pool.</p>
            <button onclick="window.open('https://app.uniswap.org/explore/tokens/polygon/0x5f9016b380782bd98d2c7893e5b2e39e95dd1378')" class="btn btn-outline">
                Open Uniswap
            </button>
        </div>
    </div>


    <!-- ================= –í–ö–õ–ê–î–ö–ê 3: –ê–î–ú–ò–ù–ö–ê ================= -->
    <div id="admin" class="tab-content">
        <h2>CEO Control Panel</h2>
        
        <div class="card">
            <h4>üí∏ Salary Batch Sender</h4>
            <p>Distribute tokens to multiple employees in one transaction.</p>
            <button onclick="alert('Module BatchTransfer is active. Connect wallet to execute.')" class="btn btn-outline">Open Payroll</button>
        </div>

        <div class="card">
            <h4>üìä Contract Status</h4>
            <p>Address: <span style="color:#aaa; font-family:monospace">0x5F9...1378</span></p>
            <p>Supply: 100,000 CRED</p>
            <button onclick="window.open('https://polygonscan.com/token/0x5f9016b380782bd98d2c7893e5b2e39e95dd1378')" class="btn btn-outline">View on Explorer</button>
        </div>
    </div>

    <!-- –õ–æ–≥–∏ (—Å–∫—Ä—ã—Ç—ã –∏–ª–∏ –≤–∏–¥–Ω—ã) -->
    <div id="console"></div>


    <!-- ================= –ù–ò–ñ–ù–ï–ï –ú–ï–ù–Æ ================= -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('wallet', this)">
            <span class="nav-icon">üëõ</span>Wallet
        </div>
        <div class="nav-item" onclick="switchTab('services', this)">
            <span class="nav-icon">‚ö°Ô∏è</span>Services
        </div>
        <div class="nav-item" onclick="switchTab('admin', this)">
            <span class="nav-icon">üîë</span>CEO
        </div>
    </div>


    <!-- ================= –õ–û–ì–ò–ö–ê (JAVASCRIPT) ================= -->
    <script>
        // –ê–î–†–ï–°–ê –í–ê–®–ò–• –ö–û–ù–¢–†–ê–ö–¢–û–í (–ò–∑ –Ω–∞—à–µ–π –ø–µ—Ä–µ–ø–∏—Å–∫–∏)
        const CRED_ADDR = '0x5F9016b380782bd98D2C7893e5b2E39e95Dd1378';
        const SUBS_ADDR = '0x88b106dc29ae1e53f3ccbc724f9cdd2b2ffb4330'; // GalacticSubs

        // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (ABI)
        const ABI_ERC20 = [
            "function approve(address spender, uint256 amount) external returns (bool)"
        ];
        const ABI_SUBS = [
            "function subscribe(uint256 _planId) external"
        ];

        let provider, signer, userAddress;

        // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function switchTab(tabId, navElement) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            // –£–±—Ä–∞—Ç—å –ø–æ–¥—Å–≤–µ—Ç–∫—É –º–µ–Ω—é
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω–æ–µ
            document.getElementById(tabId).classList.add('active');
            navElement.classList.add('active');
        }

        function log(msg) {
            const c = document.getElementById('console');
            c.innerText = "> " + msg;
            console.log(msg);
        }

        // --- –ë–õ–û–ö–ß–ï–ô–ù –õ–û–ì–ò–ö–ê ---

        async function connectWallet() {
            if (!window.ethereum) return alert('Wallet not found! Open in MetaMask app or Trust Wallet browser.');
            
            try {
                // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Ethers v6
                provider = new ethers.BrowserProvider(window.ethereum);
                
                // –ó–∞–ø—Ä–æ—Å –∞–∫–∫–∞—É–Ω—Ç–æ–≤
                signer = await provider.getSigner();
                userAddress = await signer.getAddress();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
                document.getElementById('connectBtn').innerText = "‚úÖ " + userAddress.substring(0,6) + "...";
                log("Connected: " + userAddress);

            } catch (err) {
                log("Error: " + err.message);
                alert("Connect failed. See logs.");
            }
        }

        async function addToken() {
            if (!window.ethereum) return alert('No wallet');
            try {
                await window.ethereum.request({
                    method: 'wallet_watchAsset',
                    params: {
                        type: 'ERC20',
                        options: {
                            address: CRED_ADDR,
                            symbol: 'CRED',
                            decimals: 18,
                            image: 'https://raw.githubusercontent.com/Qendl/Galactic-Credit-Standard/main/logo.png',
                        },
                    },
                });
            } catch (e) { log("Add Token error: " + e.message); }
        }

        // --- –§–£–ù–ö–¶–ò–ò –°–ï–†–í–ò–°–û–í ---

        // 1. APPROVE (–î–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É –ø–æ–¥–ø–∏—Å–æ–∫)
        async function approveCred() {
            if (!signer) { await connectWallet(); if(!signer) return; }
            
            try {
                const tokenContract = new ethers.Contract(CRED_ADDR, ABI_ERC20, signer);
                
                log("Approving 1000 CRED...");
                // 1000 —Ç–æ–∫–µ–Ω–æ–≤ —Å 18 –Ω—É–ª—è–º–∏
                const amount = ethers.parseUnits("1000", 18);
                
                const tx = await tokenContract.approve(SUBS_ADDR, amount);
                log("Tx sent. Waiting for block...");
                await tx.wait();
                
                alert("‚úÖ Approved successfully! You can subscribe now.");
                log("Approve confirmed.");
                
            } catch (err) {
                log("Approve Failed: " + err.code);
            }
        }

        // 2. SUBSCRIBE (–í—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é subscribe –Ω–∞ —Ç–∞—Ä–∏—Ñ–µ 0)
        async function subscribe() {
            if (!signer) { await connectWallet(); if(!signer) return; }

            try {
                const subContract = new ethers.Contract(SUBS_ADDR, ABI_SUBS, signer);
                
                log("Subscribing to Plan 0...");
                const tx = await subContract.subscribe(0); // 0 - —ç—Ç–æ –Ω–∞—à –ø–µ—Ä–≤—ã–π —Ç–∞—Ä–∏—Ñ
                
                log("Tx sent... Wait...");
                await tx.wait();
                
                alert("üéâ SUCCESS! You are now a VIP.");
                log("Subscription Confirmed in Block.");
                
            } catch (err) {
                log("Subscribe Failed: " + err.message);
                // –ß–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞: –Ω–µ —Å–¥–µ–ª–∞–ª–∏ Approve –∏–ª–∏ –Ω–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤
                if (err.message.includes("transfer amount exceeds")) {
                    alert("Error: Not enough CRED tokens or Approve missing.");
                }
            }
        }
    </script>
</body>
</html>
